<div class="container container-tight py-4">
  <div class="text-center mb-4">
    <!-- BEGIN NAVBAR LOGO -->
    <a routerLink="/" class="navbar-brand navbar-brand-autodark d-inline-flex align-items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
        class="icon icon-tabler icons-tabler-outline icon-tabler-brand-picsart">
        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
        <path d="M12 9m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
        <path d="M12 9m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" />
        <path d="M5 9v11a2 2 0 1 0 4 0v-4.5" />
      </svg>
      <h2 class="mb-0 fw-bold">FrameZone</h2>
    </a>
    <!-- END NAVBAR LOGO -->
  </div>

  <!-- 成功訊息 -->
  @if(successMessage) {
  <div class="alert alert-success alert-dismissible" role="alert">
    <div class="d-flex">
      <div>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon alert-icon">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M5 12l5 5l10 -10"></path>
        </svg>
      </div>
      <div>{{ successMessage }}</div>
    </div>
    <button type="button" class="btn-close" (click)="dismissSuccessMessage()" aria-label="Close"></button>
  </div>
  }

  <div class="card card-md">
    <div class="card-body">
      <h2 class="h2 text-center mb-4">登入帳號</h2>

      <!-- 錯誤訊息（顯示後端返回的訊息） -->
      @if(errorMessage) {
      <div class="alert alert-danger alert-dismissible" role="alert">
        <div class="d-flex">
          <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="icon alert-icon">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
              <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"></path>
              <path d="M12 8v4"></path>
              <path d="M12 16h.01"></path>
            </svg>
          </div>
          <div>{{ errorMessage }}</div>
        </div>
        <button type="button" class="btn-close" (click)="dismissErrorMessage()" aria-label="Close"></button>
      </div>
      }

      <!-- 登入表單 -->
      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" autocomplete="off">
        <!-- 帳號或Email -->
        <div class="mb-3">
          <label for="accountOrEmail" class="form-label">帳號或Email</label>
          <input type="text" id="accountOrEmail" formControlName="accountOrEmail" class="form-control"
            [class.is-invalid]="hasError('accountOrEmail')" placeholder="請輸入帳號或Email" autocomplete="username">
          @if(hasError('accountOrEmail')) {
          <div class="invalid-feedback">
            {{ getErrorMessage('accountOrEmail') }}
          </div>
          }
        </div>

        <!-- 密碼 -->
        <div class="mb-3">
          <label for="passwordInput" class="form-label">密碼</label>
          <div class="input-group input-group-flat">
            <input type="password" id="passwordInput" formControlName="password" class="form-control"
              [class.is-invalid]="hasError('password')" placeholder="請輸入密碼" autocomplete="current-password">
            <span class="input-group-text">
              <a href="javascript:void(0)" class="link-secondary" (click)="togglePassword()"
                [attr.title]="showPassword ? '隱藏密碼' : '顯示密碼'">
                @if(!showPassword) {
                <!-- 眼睛圖示 (顯示密碼) -->
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M10.585 10.587a2 2 0 0 0 2.829 2.828"></path>
                  <path
                    d="M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87">
                  </path>
                  <path d="M3 3l18 18"></path>
                </svg>
                } @else {

                <!-- 眼睛關閉圖示 (隱藏密碼) -->
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                  <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                </svg>
                }
              </a>
            </span>
          </div>
          @if(hasError('password')) {
          <div class="invalid-feedback d-block">
            {{ getErrorMessage('password') }}
          </div>
          }
        </div>

        <!-- 記住我 -->
        <div class="mb-2">
          <label class="form-check">
            <input type="checkbox" formControlName="rememberMe" class="form-check-input">
            <span class="form-check-label">在此裝置上記住我</span>
          </label>
        </div>

        <!-- 提交按鈕 -->
        <div class="form-footer">
          <button class="btn btn-primary w-100" type="submit" [disabled]="isSubmitting">
            @if(isSubmitting) {
            <span class="spinner-border spinner-border-sm me-2" role="status"></span>
            登入中...
            } @else {
            登入
            }
          </button>
        </div>
      </form>
    </div>

    <div class="hr-text">或</div>

    <div class="card-body">
      <div class="row">
        <div class="col">
          <!-- Github登入 (暫時停用) -->
          <a href="javascript:void(0)" class="btn btn-white w-100 disabled" title="功能開發中">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="icon text-github">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path
                d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5">
              </path>
            </svg>
            使用 Github 登入
          </a>
        </div>
        <div class="col">
          <!-- Google登入 (暫時停用) -->
          <a href="javascript:void(0)" class="btn btn-white w-100 disabled" title="功能開發中">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="icon text-google">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M17.788 5.108A9 9 0 1021 12h-8"></path>
            </svg>
            使用 Google 登入
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- 註冊連結 -->
  <div class="text-center text-secondary mt-3">
    還沒有帳號? <a routerLink="/register" class="link-primary">立即註冊</a>
  </div>
</div>
